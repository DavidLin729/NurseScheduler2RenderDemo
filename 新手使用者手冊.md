# 護理人員排班系統 - 新手使用者手冊

## 📋 目錄
1. [系統簡介](#系統簡介)
2. [下載與安裝](#下載與安裝)
3. [首次啟動](#首次啟動)
4. [基本操作流程](#基本操作流程)
5. [功能說明](#功能說明)
6. [🆕 統一導覽列系統](#統一導覽列系統)
7. [常見問題](#常見問題)
8. [聯絡資訊](#聯絡資訊)

---

## 🏥 系統簡介

**護理人員排班系統**是一套專為醫療單位設計的排班管理工具，幫助護理長或管理人員輕鬆管理護理人員的排班工作。

### ✨ 主要特色
- 🎯 **簡單易用**：無需程式背景，介面直觀友善
- 🤖 **智能排班**：自動產生排班表，節省大量時間
- 📊 **多種檢視**：月曆、表格、樞紐分析等多種檢視方式
- 📤 **匯出功能**：支援CSV格式匯出，方便與其他系統整合
- 🔒 **權限管理**：管理員與一般使用者權限分級
- 📝 **完整記錄**：所有操作都有詳細記錄，便於追蹤
- 🆕 **請假管理**：完整的員工請假管理系統，與排班系統無縫整合
- 🆕 **統一導覽列**：響應式導覽列系統，提供一致的使用體驗

### 🎯 適用對象
- 護理長、護理部主任
- 人力資源管理人員
- 醫療單位行政人員
- 需要管理護理人員排班的相關人員

---

## 💻 下載與安裝

### 步驟1：下載系統檔案

#### 方法一：直接下載（推薦新手使用）
1. 開啟瀏覽器，前往：https://github.com/DavidLin729/NurseScheduler2
2. 點擊綠色的「Code」按鈕
3. 選擇「Download ZIP」
4. 等待下載完成

#### 方法二：使用Git（進階使用者）
如果您熟悉Git，可以在命令提示字元中輸入：
```bash
git clone https://github.com/DavidLin729/NurseScheduler2.git
```

### 步驟2：安裝Python

#### 檢查是否已安裝Python
1. 按 `Win + R` 開啟執行視窗
2. 輸入 `cmd` 按確定
3. 在命令提示字元中輸入：`python --version`
4. 如果顯示版本號（如 Python 3.8.0），表示已安裝

#### 安裝Python（如果尚未安裝）
1. 前往 https://www.python.org/downloads/
2. 點擊「Download Python 3.x.x」（選擇最新版本）
3. 下載完成後，**重要**：安裝時請勾選「Add Python to PATH」
4. 完成安裝

### 步驟3：解壓縮系統檔案
1. 找到下載的 `NurseScheduler2-master.zip` 檔案
2. 右鍵點擊 → 選擇「解壓縮全部」
3. 選擇解壓縮位置（建議放在桌面或文件夾）
4. 解壓縮完成後，您會看到一個名為 `NurseScheduler2-master` 的資料夾

### 步驟4：安裝必要套件
1. 開啟命令提示字元（按 `Win + R`，輸入 `cmd`）
2. 使用 `cd` 命令切換到系統資料夾：
   ```bash
   cd C:\Users\[您的使用者名稱]\Desktop\NurseScheduler2-master
   ```
   （請將路徑改為您實際的解壓縮位置）
3. 輸入以下命令安裝必要套件：
   ```bash
   pip install -r requirements.txt
   ```
4. 等待安裝完成

---

## 🚀 首次啟動

### 啟動系統
1. 在命令提示字元中，確保您在系統資料夾內
2. 輸入以下命令啟動系統：
   ```bash
   python app.py
   ```
3. 如果成功，您會看到類似以下的訊息：
   ```
   * Running on http://127.0.0.1:5001
   * Debug mode: on
   ```
4. 開啟瀏覽器，前往：http://127.0.0.1:5001

### 首次登入
- **預設管理員帳號**：admin
- **預設密碼**：admin123
- **建議**：首次登入後立即修改密碼

---

## 📝 基本操作流程

### 1. 人員管理
1. 點擊左側選單「人員管理」
2. 點擊「新增人員」或使用「批次上傳」
3. 填寫人員資料：
   - 員工編號（必填）
   - 姓名（必填）
   - 職稱
   - 病房

### 2. 班別設定
1. 點擊「班別管理」
2. 新增班別：
   - 班別編號（如：S1）
   - 班別名稱（如：早班）
   - 時間（如：07:00-15:00）
   - 需求人數
   - 病房

### 3. 請假管理（🆕 新功能）
1. 點擊「請假管理」
2. 新增請假記錄：
   - 選擇員工
   - 選擇假別（事假、病假、特休等）
   - 設定起始與結束日期
   - 填寫請假原因（可選）
   - 設定核准狀態
3. 批次上傳：
   - 點擊「下載模板」取得CSV範本
   - 填寫請假資料後上傳
4. 查詢篩選：
   - 依日期範圍篩選
   - 依員工或假別篩選

### 4. 自動排班
1. 點擊「自動排班」
2. 選擇排班月份或日期範圍
3. 設定排班參數：
   - 每日最多班數
   - 每月班數上下限
   - 是否啟用公平分配
   - 四周變形工時設定
4. 點擊「開始排班」
   - **系統會自動檢查請假狀態，請假期間的員工不會被排班**

### 5. 檢視班表
- **月曆檢視**：以月曆形式顯示班表
- **表格檢視**：以表格形式顯示詳細資料
- **員工橫式排班表**：以員工為主的橫式檢視

### 6. 匯出班表
1. 在班表檢視頁面點擊「匯出 CSV」
2. 設定替代代碼（可選）：
   - 早班 → D
   - 小夜班 → E
   - 大夜班 → N
   - 例假日 → H
   - 休息日 → R
3. 點擊「確認匯出」

---

## 🔧 功能說明

### 📊 主要功能模組

#### 人員管理
- **新增/編輯人員**：管理護理人員基本資料
- **批次上傳**：使用CSV檔案大量新增人員
- **搜尋篩選**：快速找到特定人員

#### 班別管理
- **班別設定**：定義各種班別（早班、小夜班、大夜班等）
- **每日需求人數**：設定每種班別在不同日期的需求人數
- **病房分組**：依病房分組管理班別

#### 排班偏好設定
- **單一班別**：指定人員只排特定班別
- **雙班別模式**：指定人員排兩種班別，可設定週次模式
- **週次模式**：交替週次或連續週次

#### 假日On Call管理
- **星期天On Call**：專門管理星期天的On Call人員
- **批次設定**：自動為整月星期天分配On Call人員
- **狀態管理**：主要On Call、備援On Call、休息

#### 大夜班預先分配
- **日期範圍分配**：為特定日期範圍預先分配大夜班人員
- **批次分配**：自動按週分配大夜班
- **跨月份支援**：支援跨月份的分配設定

#### 請假管理（🆕 新功能）
- **完整CRUD功能**：新增、編輯、刪除、查詢請假記錄
- **多種假別支援**：事假、病假、特休、婚假、喪假、產假、陪產假、其他
- **批次處理**：支援CSV模板下載與批次上傳
- **查詢篩選**：日期範圍、員工、假別、核准狀態等多條件篩選
- **核准狀態管理**：支援核准/未核准狀態設定
- **智能天數計算**：自動計算請假天數，**星期天不計入請假天數**
- **排班表顯示**：請假的星期天顯示為「例假日」，平日請假顯示為「其他排休」
- **排班整合**：與自動排班系統無縫整合，請假期間不會被排班
- **星期天限制**：請假包含星期天時，該星期天不會安排大夜班或On Call

#### 自動排班
- **智能排班**：根據設定的規則自動產生排班表
- **請假優先檢查**：排班前會優先檢查員工請假狀態（第一優先級）
- **規則驗證**：確保排班結果符合所有規則
- **重新生成**：如果結果不符合需求，可自動重新生成

#### 班表檢視
- **月曆檢視**：使用FullCalendar.js呈現班表
- **表格檢視**：詳細的班表資料檢視
- **員工橫式排班表**：以員工為主的橫式檢視
- **樞紐分析**：使用PivotTable.js進行深度分析

#### 匯出功能
- **CSV匯出**：支援多種格式的CSV匯出
- **文字替代**：可設定代碼替代班別名稱
- **智能命名**：根據設定自動調整檔案名稱

### 🎨 介面特色
- **粉紅主題**：統一的視覺設計
- **響應式設計**：支援不同螢幕尺寸
- **圖示支援**：使用Bootstrap Icons提供直覺操作
- **操作提示**：完整的成功/錯誤訊息

---

## 🆕 統一導覽列系統

### 🎯 導覽列功能介紹
系統現在提供統一的導覽列，讓您在任何頁面都能快速導航到其他功能。

### 📱 導覽列使用方式

#### 桌面版導覽列
- **系統管理**（管理員專用）：
  - 使用者管理：管理系統使用者帳號與權限
  - 人員管理：新增、編輯護理人員基本資料
  - 班別設定：設定各種班別類型與時間
  - 自動排班：使用智能演算法自動產生排班表
  - 請假管理：處理員工請假申請與核准
  - On Call 管理：安排星期天的 On Call 人員
  - 大夜班分配：預先設定大夜班人員分配

- **班表管理**：
  - 班表查詢：查看與搜尋排班表
  - 員工橫式班表：以人員為主的班表檢視
  - 週工時統計：查看每週工時統計與分析
  - 班表異動紀錄（管理員）：查看排班表的修改歷史
  - 班表分析：樞紐分析表檢視排班數據

- **首頁**：快速回到系統首頁

#### 手機版導覽列
- 點擊右上角的漢堡選單圖示（☰）
- 展開後會顯示所有可用的功能選單
- 功能分類與桌面版相同

### 🎨 視覺特色
- **統一設計**：所有頁面都有相同的導覽列設計
- **粉色主題**：延續系統的粉色主題色彩
- **圖示支援**：每個功能都有對應的圖示，方便識別
- **響應式設計**：自動適應不同螢幕尺寸

### 🔐 權限控制
- **管理員**：可以看到所有功能選單
- **一般使用者**：只能看到班表管理相關功能
- **用戶資訊**：右上角顯示當前登入用戶和角色

### 💡 使用技巧
1. **快速導航**：在任何頁面都能快速切換到其他功能
2. **功能分類**：下拉式選單提供清晰的功能分類
3. **角色區分**：根據您的權限會看到不同的功能選項
4. **首頁連結**：隨時可以回到系統首頁

---

## ❓ 常見問題

### Q1：系統無法啟動怎麼辦？
**A：** 請檢查以下項目：
1. Python是否正確安裝（在命令提示字元輸入 `python --version`）
2. 是否在正確的資料夾內執行命令
3. 必要套件是否已安裝（執行 `pip install -r requirements.txt`）

### Q2：忘記密碼怎麼辦？
**A：** 系統預設管理員帳號：
- 帳號：admin
- 密碼：admin123

### Q3：如何備份資料？
**A：** 系統資料儲存在 `/var/data/staff.db` 檔案中（生產環境）或 `data/staff.db`（本地開發），建議定期複製此檔案作為備份。

### Q4：導覽列功能選單不顯示怎麼辦？
**A：** 請檢查：
1. 是否已正確登入系統
2. 您的帳號權限是否為管理員
3. 瀏覽器是否支援 JavaScript
4. 嘗試重新整理頁面

### Q5：手機版導覽列無法使用？
**A：** 請確認：
1. 瀏覽器是否為最新版本
2. 是否允許 JavaScript 執行
3. 網路連線是否正常

### Q6：排班結果不符合需求怎麼辦？
**A：** 系統提供重新生成功能，您也可以：
1. 調整排班參數
2. 設定排班偏好
3. 預先分配特定班別
4. 手動編輯排班結果

### Q7：如何匯出特定格式的班表？
**A：** 使用「匯出 CSV」功能，在設定視窗中：
1. 設定班別替代代碼
2. 設定休假替代代碼
3. 可自訂其他班別名稱的替代

### Q8：如何設定員工請假？
**A：** 請假管理操作步驟：
1. 登入管理員帳號
2. 點擊「請假管理」
3. 點擊「新增請假」填寫資料
4. 或使用「下載模板」進行批次上傳
5. 系統會在自動排班時優先檢查請假狀態

### Q9：請假資料可以批次匯入嗎？
**A：** 可以，請按照以下步驟：
1. 在請假管理頁面點擊「下載模板」
2. 在CSV檔案中填寫請假資料
3. 確保員工編號正確且存在於系統中
4. 上傳檔案，系統會驗證並顯示結果

### Q10：請假包含星期天時如何計算天數？
**A：** 系統遵循勞動法規，星期天為法定例假日：
1. **天數計算**：星期天不計入實際請假天數
2. **範例**：請假7天（週一到週日）= 實際請假6天（排除週日）
3. **顯示方式**：**6** 天 *(總 7 天，含 1 個星期天)*
4. **排班表顯示**：請假的星期天顯示為「例假日」，平日顯示為「其他排休」

### Q11：請假期間的星期天可以排班嗎？
**A：** 不可以，系統會自動處理：
1. **大夜班限制**：請假包含星期天時，該星期天不會安排大夜班
2. **On Call限制**：請假員工不會被安排星期天On Call
3. **自動警告**：如果所有員工都請假，系統會警告無法安排On Call
4. **排班優先級**：請假檢查是自動排班的第一優先級

### Q12：系統支援哪些瀏覽器？
**A：** 建議使用：
- Google Chrome（推薦）
- Microsoft Edge
- Firefox
- Safari

---

## 📞 聯絡資訊

### 🛠️ 技術支援
如果您在使用過程中遇到任何問題，或有功能建議，歡迎與我們聯絡：

**📧 電子郵件**：[您的信箱]
**💼 LinkedIn**：[您的LinkedIn帳號]

### 📋 聯絡時請提供
為了更快解決您的問題，聯絡時請提供：
1. **問題描述**：詳細描述您遇到的問題
2. **操作步驟**：重現問題的具體步驟
3. **系統資訊**：
   - 作業系統版本
   - Python版本
   - 瀏覽器版本
4. **錯誤訊息**：如果有錯誤訊息，請一併提供
5. **螢幕截圖**：問題的螢幕截圖（如果適用）

### 🚀 功能建議
我們持續改進系統功能，如果您有：
- 新功能建議
- 介面改善建議
- 使用體驗回饋
- 其他想法

都歡迎與我們分享！

---

## 📄 版本資訊

**當前版本**：v2.5.1  
**最後更新**：2025年1月15日  
**系統需求**：Python 3.8+  
**授權方式**：開源專案

### 🆕 v2.5.1 新增功能
- **星期天請假處理機制**：智能天數計算，星期天不計入請假天數
- **「其他排休」功能**：請假與休息日視覺區分，灰白色背景顯示
- **排班表顯示優化**：請假星期天顯示為例假日，平日請假顯示為其他排休
- **自動排班限制**：請假星期天不安排大夜班或On Call
- **用戶介面增強**：新增詳細說明與統計資訊

### 🆕 v2.5.0 新增功能
- **請假管理系統**：完整的員工請假管理功能
- **自動排班整合**：請假檢查設為第一優先級
- **批次處理**：請假資料的批次上傳/下載
- **多條件查詢**：日期範圍、員工、假別等篩選功能

---

## 🙏 感謝使用

感謝您選擇使用護理人員排班系統！我們致力於為醫療單位提供最優質的排班管理解決方案。

如果您覺得本系統對您的工作有幫助，歡迎：
- ⭐ 在GitHub上給我們星標
- 📝 分享使用心得
- 🔗 推薦給其他需要的單位

**讓我們一起讓護理人員的排班工作更輕鬆、更有效率！**

---

*本手冊最後更新：2025年7月14日*  
*如有任何問題，請隨時與我們聯絡* 